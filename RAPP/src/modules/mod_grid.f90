!==========================================================================================!
!==========================================================================================!
! Module grid: This module contains the input grid structure.                              !
!------------------------------------------------------------------------------------------!
module mod_grid
   implicit none

   type grid_struct
      real, pointer, dimension(:,:  ) :: lon
      real, pointer, dimension(:,:  ) :: lat
   end type grid_struct

   !---------------------------------------------------------------------------------------!
   !    Full domain grid.                                                                  !
   !---------------------------------------------------------------------------------------!
   type(grid_struct), dimension(:), allocatable :: grid_g
   
   !=======================================================================================!
   !=======================================================================================!


   contains



   !=======================================================================================!
   !=======================================================================================!
   subroutine alloc_grid(grid,nx,ny)
      implicit none 
      !----- Arguments. -------------------------------------------------------------------!
      type(grid_struct), intent(inout) :: grid
      integer          , intent(in)    :: nx,ny
      !------------------------------------------------------------------------------------!

      allocate(grid%lon (nx,ny   ))
      allocate(grid%lat (nx,ny   ))

      return
   end subroutine alloc_grid
   !=======================================================================================!
   !=======================================================================================!






   !=======================================================================================!
   !=======================================================================================!
   subroutine nullify_grid(grid)
      implicit none
      !----- Arguments. -------------------------------------------------------------------!
      type(grid_struct), intent(inout) :: grid
      !------------------------------------------------------------------------------------!

      if (associated(grid%lon )) nullify(grid%lon )
      if (associated(grid%lat )) nullify(grid%lat )

      return
   end subroutine nullify_grid
   !=======================================================================================!
   !=======================================================================================!






   !=======================================================================================!
   !=======================================================================================!
   subroutine zero_grid(grid)
      implicit none
      !----- Arguments. -------------------------------------------------------------------!
      type(grid_struct), intent(inout) :: grid
      !------------------------------------------------------------------------------------!

      if (associated(grid%lon )) grid%lon  = 0.0
      if (associated(grid%lat )) grid%lat  = 0.0

      return
   end subroutine zero_grid
   !=======================================================================================!
   !=======================================================================================!






   !=======================================================================================!
   !=======================================================================================!
   subroutine dealloc_grid(grid)
      implicit none
      !----- Arguments. -------------------------------------------------------------------!
      type(grid_struct), intent(inout) :: grid
      !------------------------------------------------------------------------------------!

      if (associated(grid%lon )) deallocate(grid%lon )
      if (associated(grid%lat )) deallocate(grid%lat )

      return
   end subroutine dealloc_grid
   !=======================================================================================!
   !=======================================================================================!
end module mod_grid
!==========================================================================================!
!==========================================================================================!

